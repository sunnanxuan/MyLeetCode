class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        dic = collections.defaultdict(list)
        n = len(graph)
        for i, g in enumerate(graph):
            for j in range(n):
                if g[j] == 1 and j != i:
                    dic[i].append(j)
        spread = {}
        for i in initial:
            if i not in spread:
                visited = set()
                q = [i]
                visited.add(i)
                while q:
                    new = []
                    for j in q:
                        for k in dic[j]:
                            if k not in visited:
                                visited.add(k)
                                new.append(k)
                    q = new
                for c in visited:
                    if c in initial: spread[c] = visited
        count = {}
        for i in initial:
            cur = set()
            for j in initial:
                if j != i: cur |= spread[j]
            count[i] = len(cur)
        arr = list(count.items())
        arr.sort(key=lambda x: (x[1], x[0]))
        return arr[0][0]



